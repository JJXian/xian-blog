"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[651],{9651:function(e,t,o){o.r(t),o.d(t,{default:function(){return p}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("div",{staticStyle:{width:"400px",padding:"50px 30px","background-color":"white","border-radius":"5px"}},[t("div",{staticStyle:{"text-align":"center","font-size":"24px","margin-bottom":"30px",color:"#333"}},[e._v("技术研习博客")]),t("el-form",{ref:"formRef",attrs:{model:e.form,rules:e.rules},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login.apply(null,arguments)}}},[t("el-form-item",{attrs:{prop:"username"}},[t("el-input",{attrs:{size:"medium","prefix-icon":"el-icon-user",placeholder:"请输入账号"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),t("el-form-item",{attrs:{prop:"password"}},[t("el-input",{attrs:{size:"medium","prefix-icon":"el-icon-lock",placeholder:"请输入密码","show-password":""},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),t("el-form-item",{attrs:{prop:"role"}},[t("el-radio-group",{model:{value:e.form.role,callback:function(t){e.$set(e.form,"role",t)},expression:"form.role"}},[t("el-radio",{attrs:{label:"USER"}},[e._v("用户")]),t("el-radio",{attrs:{label:"ADMIN"}},[e._v("管理员")])],1)],1),t("el-form-item",{attrs:{prop:"code"}},[t("div",{staticStyle:{display:"flex"}},[t("el-input",{staticStyle:{flex:"1"},attrs:{size:"medium"},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}}),t("Identify",{attrs:{identifyCode:e.identifyCode},nativeOn:{click:function(t){return e.refreshCode.apply(null,arguments)}}})],1)]),t("el-form-item",[t("el-button",{staticStyle:{width:"100%","background-color":"#2a60c9","border-color":"#2a60c9",color:"white"},attrs:{size:"medium"},on:{click:e.login}},[e._v("登 录")])],1),t("div",{staticStyle:{display:"flex","align-items":"center"}},[t("div",{staticStyle:{flex:"1"}}),t("div",{staticStyle:{flex:"1","text-align":"right"}},[e._v(" 还没有账号？请 "),t("a",{attrs:{href:"/register"}},[e._v("注册")])])])],1)],1)])},r=[],n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"s-canvas"},[t("canvas",{attrs:{id:"s-canvas",width:e.contentWidth,height:e.contentHeight}})])},s=[],a={name:"Identify",props:{identifyCode:{type:String,default:"1234"},fontSizeMin:{type:Number,default:28},fontSizeMax:{type:Number,default:40},backgroundColorMin:{type:Number,default:180},backgroundColorMax:{type:Number,default:240},colorMin:{type:Number,default:50},colorMax:{type:Number,default:160},lineColorMin:{type:Number,default:40},lineColorMax:{type:Number,default:180},dotColorMin:{type:Number,default:0},dotColorMax:{type:Number,default:255},contentWidth:{type:Number,default:112},contentHeight:{type:Number,default:35}},methods:{randomNum(e,t){return Math.floor(Math.random()*(t-e)+e)},randomColor(e,t){var o=this.randomNum(e,t),i=this.randomNum(e,t),r=this.randomNum(e,t);return"rgb("+o+","+i+","+r+")"},drawPic(){var e=document.getElementById("s-canvas"),t=e.getContext("2d");t.textBaseline="bottom",t.fillStyle=this.randomColor(this.backgroundColorMin,this.backgroundColorMax),t.fillRect(0,0,this.contentWidth,this.contentHeight);for(let o=0;o<this.identifyCode.length;o++)this.drawText(t,this.identifyCode[o],o);this.drawLine(t),this.drawDot(t)},drawText(e,t,o){e.fillStyle=this.randomColor(this.colorMin,this.colorMax),e.font=this.randomNum(this.fontSizeMin,this.fontSizeMax)+"px SimHei";var i=(o+1)*(this.contentWidth/(this.identifyCode.length+1)),r=this.randomNum(this.fontSizeMax,this.contentHeight-5),n=this.randomNum(-30,30);e.translate(i,r),e.rotate(n*Math.PI/270),e.fillText(t,0,0),e.rotate(-n*Math.PI/270),e.translate(-i,-r)},drawLine(e){for(let t=0;t<2;t++)e.strokeStyle=this.randomColor(this.lineColorMin,this.lineColorMax),e.beginPath(),e.moveTo(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight)),e.lineTo(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight)),e.stroke()},drawDot(e){for(let t=0;t<20;t++)e.fillStyle=this.randomColor(0,255),e.beginPath(),e.arc(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight),1,0,2*Math.PI),e.fill()}},watch:{identifyCode(){this.drawPic()}},mounted(){this.drawPic()}},l=a,d=o(3736),h=(0,d.Z)(l,n,s,!1,null,"32112728",null),m=h.exports,u={name:"Login",components:{Identify:m},data(){return{form:{role:"USER"},rules:{username:[{required:!0,message:"请输入账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},code:"",identifyCode:"",identifyCodes:"123456789ABCDEFGHGKMNPQRSTUVWXY"}},mounted(){this.refreshCode()},methods:{refreshCode(){this.identifyCode="",this.makeCode(this.identifyCodes,4)},makeCode(e,t){for(let o=0;o<t;o++)this.identifyCode+=this.identifyCodes[Math.floor(Math.random()*this.identifyCodes.length)]},login(){return this.code?this.code.toLowerCase()!==this.identifyCode.toLowerCase()?(this.$message.warning("验证码错误"),void this.refreshCode()):void this.$refs["formRef"].validate((e=>{e&&this.$request.post("/login",this.form).then((e=>{"200"===e.code?(localStorage.setItem("xm-user",JSON.stringify(e.data)),this.$message.success("登录成功"),setTimeout((()=>{"ADMIN"===e.data.role?location.href="/home":location.href="/front/home"}),500)):(this.refreshCode(),this.$message.error(e.msg))}))})):(this.$message.warning("请输入验证码"),void this.refreshCode())}}},f=u,c=(0,d.Z)(f,i,r,!1,null,"5144af92",null),p=c.exports}}]);
//# sourceMappingURL=651.7083d39c.js.map